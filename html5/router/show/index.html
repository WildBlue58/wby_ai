<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>HTML5 è·¯ç”±ç¤ºä¾‹-ä¹¡ä¹¡ğŸ’•</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        max-width: 800px;
        margin: 0 auto;
        padding: 20px;
        line-height: 1.6;
      }

      nav {
        background: #f4f4f4;
        padding: 15px;
        border-radius: 5px;
        margin-bottom: 20px;
      }

      nav a {
        margin-right: 15px;
        text-decoration: none;
        color: #333;
        padding: 5px 10px;
        border-radius: 3px;
        transition: background-color 0.3s;
      }

      nav a:hover {
        background-color: #ddd;
      }

      nav a.active {
        background-color: #007bff;
        color: white;
      }

      #content {
        min-height: 300px;
        padding: 20px;
        border: 1px solid #ddd;
        border-radius: 5px;
        background: white;
      }

      .page {
        display: none;
      }

      .page.active {
        display: block;
      }

      .info {
        background: #e7f3ff;
        padding: 15px;
        border-radius: 5px;
        margin-bottom: 20px;
        border-left: 4px solid #007bff;
      }

      .code {
        background: #f8f9fa;
        padding: 10px;
        border-radius: 3px;
        font-family: monospace;
        margin: 10px 0;
      }
    </style>
  </head>
  <body>
    <h1>HTML5 è·¯ç”±ç¤ºä¾‹-ä¹¡ä¹¡ğŸ’•</h1>

    <div class="info">
      <strong>å½“å‰URL:</strong> <span id="current-url"></span><br />
      <strong>å†å²è®°å½•é•¿åº¦:</strong> <span id="history-length"></span>
    </div>

    <nav>
      <a href="/" data-route="/">é¦–é¡µ</a>
      <a href="/about" data-route="/about">å…³äºæˆ‘ä»¬</a>
      <a href="/contact" data-route="/contact">è”ç³»æˆ‘ä»¬</a>
      <a href="/products" data-route="/products">äº§å“å±•ç¤º</a>
    </nav>

    <div id="content">
      <div id="home" class="page active">
        <h2>é¦–é¡µ</h2>
        <p>æ¬¢è¿æ¥åˆ°æˆ‘ä»¬çš„ç½‘ç«™ï¼è¿™æ˜¯ä¸€ä¸ªHTML5è·¯ç”±çš„æ¼”ç¤ºã€‚</p>
        <p>ç‚¹å‡»ä¸Šé¢çš„å¯¼èˆªé“¾æ¥ï¼Œæ‚¨ä¼šçœ‹åˆ°URLä¼šæ”¹å˜ï¼Œä½†é¡µé¢ä¸ä¼šåˆ·æ–°ã€‚</p>
        <div class="code">
          // ä½¿ç”¨ history.pushState() æ›´æ–°URL<br />
          history.pushState({}, '', '/about');
        </div>
      </div>

      <div id="about" class="page">
        <h2>å…³äºæˆ‘ä»¬</h2>
        <p>æˆ‘æ˜¯ä¸€ä¸ªçˆ±æ‘¸é±¼çš„æ–°ç”Ÿå°ç™½ã€‚</p>
        <p>HTML5çš„History APIè®©æˆ‘ä»¬èƒ½å¤Ÿåˆ›å»ºæ›´å¥½çš„ç”¨æˆ·ä½“éªŒã€‚</p>
        <div class="code">
          // ç›‘å¬ popstate äº‹ä»¶å¤„ç†æµè§ˆå™¨å‰è¿›/åé€€<br />
          window.addEventListener('popstate', handlePopState);
        </div>
      </div>

      <div id="contact" class="page">
        <h2>è”ç³»æˆ‘ä»¬</h2>
        <p>é‚®ç®±: 2398205893@qq.com</p>
        <p>ç”µè¯: æˆ‘ä¸å¯„åˆ°å“‡</p>
        <p>åœ°å€: æ±Ÿè¥¿è€è¡¨</p>
        <div class="code">
          // æ›¿æ¢å½“å‰å†å²è®°å½•<br />
          history.replaceState({}, '', '/contact');
        </div>
      </div>

      <div id="products" class="page">
        <h2>äº§å“å±•ç¤º</h2>
        <p>æˆ‘ä»¬çš„äº§å“åŒ…æ‹¬ï¼š</p>
        <ul>
          <li>Webåº”ç”¨å¼€å‘</li>
          <li>ç§»åŠ¨ç«¯é€‚é…</li>
          <li>æ€§èƒ½ä¼˜åŒ–</li>
          <li>ç”¨æˆ·ä½“éªŒè®¾è®¡</li>
        </ul>
        <div class="code">
          // è·¯ç”±é…ç½®å¯¹è±¡<br />
          const routes = {<br />
          &nbsp;&nbsp;'/': 'home',<br />
          &nbsp;&nbsp;'/about': 'about',<br />
          &nbsp;&nbsp;'/contact': 'contact',<br />
          &nbsp;&nbsp;'/products': 'products'<br />
          };
        </div>
      </div>
    </div>

    <div class="info">
      <h3>HTML5è·¯ç”±çš„æ ¸å¿ƒç‰¹æ€§ï¼š</h3>
      <ul>
        <li><strong>pushState()</strong>: å‘å†å²è®°å½•æ ˆæ·»åŠ æ–°è®°å½•</li>
        <li><strong>replaceState()</strong>: æ›¿æ¢å½“å‰å†å²è®°å½•</li>
        <li><strong>popstateäº‹ä»¶</strong>: ç›‘å¬æµè§ˆå™¨å‰è¿›/åé€€æ“ä½œ</li>
        <li><strong>æ— åˆ·æ–°å¯¼èˆª</strong>: é¡µé¢å†…å®¹åŠ¨æ€æ›´æ–°ï¼ŒURLåŒæ­¥å˜åŒ–</li>
      </ul>
    </div>

    <script>
      // è·¯ç”±é…ç½®
      const routes = {
        "/": "home",
        "/about": "about",
        "/contact": "contact",
        "/products": "products",
      };

      // å½“å‰é¡µé¢ID
      let currentPage = "home";

      // åˆå§‹åŒ–
      document.addEventListener("DOMContentLoaded", function () {
        // è®¾ç½®åˆå§‹URLæ˜¾ç¤º
        updateUrlDisplay();

        // ç»‘å®šå¯¼èˆªäº‹ä»¶
        bindNavigationEvents();

        // ç›‘å¬popstateäº‹ä»¶
        window.addEventListener("popstate", handlePopState);

        // å¤„ç†åˆå§‹è·¯ç”±
        handleRoute(window.location.pathname);
      });

      // ç»‘å®šå¯¼èˆªäº‹ä»¶
      function bindNavigationEvents() {
        const navLinks = document.querySelectorAll("nav a");

        navLinks.forEach((link) => {
          link.addEventListener("click", function (e) {
            e.preventDefault();
            const route = this.getAttribute("data-route");
            navigate(route);
          });
        });
      }

      // å¯¼èˆªå‡½æ•°
      function navigate(path) {
        // ä½¿ç”¨pushStateæ›´æ–°URL
        history.pushState({}, "", path);

        // å¤„ç†è·¯ç”±
        handleRoute(path);

        // æ›´æ–°URLæ˜¾ç¤º
        updateUrlDisplay();
      }

      // å¤„ç†è·¯ç”±
      function handleRoute(path) {
        const pageId = routes[path] || "home";

        // éšè—æ‰€æœ‰é¡µé¢
        document.querySelectorAll(".page").forEach((page) => {
          page.classList.remove("active");
        });

        // æ˜¾ç¤ºç›®æ ‡é¡µé¢
        const targetPage = document.getElementById(pageId);
        if (targetPage) {
          targetPage.classList.add("active");
          currentPage = pageId;
        }

        // æ›´æ–°å¯¼èˆªçŠ¶æ€
        updateNavigationState(path);
      }

      // å¤„ç†popstateäº‹ä»¶
      function handlePopState() {
        handleRoute(window.location.pathname);
        updateUrlDisplay();
      }

      // æ›´æ–°å¯¼èˆªçŠ¶æ€
      function updateNavigationState(path) {
        // ç§»é™¤æ‰€æœ‰activeç±»
        document.querySelectorAll("nav a").forEach((link) => {
          link.classList.remove("active");
        });

        // æ·»åŠ activeç±»åˆ°å½“å‰è·¯ç”±
        const activeLink = document.querySelector(
          `nav a[data-route="${path}"]`
        );
        if (activeLink) {
          activeLink.classList.add("active");
        }
      }

      // æ›´æ–°URLæ˜¾ç¤º
      function updateUrlDisplay() {
        document.getElementById("current-url").textContent =
          window.location.pathname;
        document.getElementById("history-length").textContent = history.length;
      }

      // æ¼”ç¤ºå‡½æ•°ï¼šæ‰‹åŠ¨è§¦å‘è·¯ç”±
      function demoNavigate(path) {
        console.log(`å¯¼èˆªåˆ°: ${path}`);
        navigate(path);
      }

      // åœ¨æ§åˆ¶å°ä¸­å¯ä»¥è°ƒç”¨ demoNavigate('/about') æ¥æµ‹è¯•
      console.log("å¯ä»¥åœ¨æ§åˆ¶å°ä¸­ä½¿ç”¨ demoNavigate(path) æ¥æµ‹è¯•è·¯ç”±");
    </script>
  </body>
</html>
